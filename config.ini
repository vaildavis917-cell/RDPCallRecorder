; ============================================================
; RDP Call Recorder Agent — Конфигурация
; Версия: 2.6
; ============================================================
; Этот файл должен лежать рядом с RDPCallRecorder.exe
; Все параметры имеют значения по умолчанию.

[Recording]
; Путь для сохранения записей.
; Структура: {RecordingPath}\{ПолноеИмя}\{YYYY-MM-DD}\{Дата}_{ПолноеИмя}_{Приложение}_{Время}.mp3
; ПолноеИмя берётся из профиля Windows (например: Nicole, Vladislav AFF)
; Путь по умолчанию: %USERPROFILE%\CallRecordings
; Оставьте пустым для автоопределения, или укажите свой путь
RecordingPath=

; Формат записи: mp3, wav
AudioFormat=mp3

; Битрейт MP3 (рекомендуется 128000 для голоса)
MP3Bitrate=128000

[Monitoring]
; Интервал проверки активности звонков (секунды). Рекомендуется 2.
PollInterval=2

; Порог тишины: сколько циклов подряд нет аудио, прежде чем остановить запись.
; При PollInterval=2 и SilenceThreshold=3 — запись остановится через ~6 сек тишины.
SilenceThreshold=3

; Порог старта: сколько циклов подряд РЕАЛЬНЫЙ звук должен быть активен,
; прежде чем начать запись. Защищает от ложных срабатываний на уведомления.
; При PollInterval=2 и StartThreshold=2 — запись начнётся через ~4 сек непрерывного звука.
; Увеличьте до 3-4 если уведомления всё ещё вызывают запись.
StartThreshold=2

; === Telegram-специфичные настройки ===
; Telegram не закрывает аудиосессию после звонка — она остаётся активной
; с микро-пиками (0.001-0.02). Обычная детекция тишины не срабатывает.
; Для Telegram используется скользящее среднее пика за последние N циклов.

; Порог среднего пика для Telegram: если средний пик ниже этого значения,
; считается тишиной. По умолчанию 0.03 (3%).
TelegramSilencePeakThreshold=0.03

; Размер окна скользящего среднего (в циклах опроса).
; При PollInterval=2 и TelegramPeakHistorySize=5 — усреднение за 10 секунд.
TelegramPeakHistorySize=5

; Сколько циклов подряд средний пик должен быть ниже порога,
; чтобы остановить запись Telegram.
; При PollInterval=2 и TelegramSilenceCycles=5 — запись остановится через ~10 сек.
TelegramSilenceCycles=5

[Processes]
; Список процессов для мониторинга (через запятую)
TargetProcesses=WhatsApp.exe,Telegram.exe,Viber.exe

[Logging]
EnableLogging=true
LogLevel=DEBUG
MaxLogSizeMB=10

[Advanced]
; Скрывать окно (true для production)
HideConsole=true

; Мьютекс — один экземпляр на RDP-сессию
UseMutex=true
MutexName=Local\RDPCallRecorderAgentMutex

; Приоритет процесса (BelowNormal — минимальная нагрузка)
ProcessPriority=BelowNormal

; Автоматически прописывать себя в автозапуск при первом запуске
AutoRegisterStartup=true

; Автообновление через GitHub Releases
; Агент проверяет наличие новой версии при старте и каждые N часов
AutoUpdate=true
UpdateCheckIntervalHours=6

Configured=true
